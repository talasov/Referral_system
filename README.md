# Реферальная система API

Данное API предоставляет простую реферальную систему, позволяющую пользователям авторизовываться по номеру телефона, получать и активировать инвайт-коды, а также просматривать профили других пользователей, которые использовали их инвайт-коды.

## Оглавление

- [Авторизация по номеру телефона](#авторизация-по-номеру-телефона)
- [Запрос на профиль пользователя](#запрос-на-профиль-пользователя)
- [Ввод чужого инвайт-кода](#ввод-чужого-инвайт-кода)

## Авторизация по номеру телефона

1. Пользователь отправляет POST-запрос на `api/authorize/` с параметром `phone_number` для запроса кода авторизации.
2. Сервер проверяет корректность номера телефона, генерирует 4-значный код и отправляет его в ответ.
3. Пользователь отправляет POST-запрос на `api/verify/` с параметрами `phone_number` и `auth_code` для верификации.
4. Сервер проверяет код авторизации, проверяет, есть ли в базе пользователь с данным номером телефона, и возвращает сообщение об успешной авторизации, а также присваивает пользователю рандомно сгенерированный 6-значный `invite_code`.

## Запрос на профиль пользователя

1. Пользователь отправляет GET-запрос на `api/profile/` для получения своего профиля.
2. Сервер возвращает данные профиля пользователя, такие как `phone_number`, `invite_code` и, если есть, `referral_code`.
3. Также сервер возвращает список номеров телефонов пользователей, которые ввели инвайт-код текущего пользователя.

## Ввод чужого инвайт-кода

1. Пользователь отправляет POST-запрос на `api/assign-referral-code/` с параметром `referral_code` для активации чужого инвайт-кода.
2. Сервер проверяет наличие переданного `referral_code` и сверяет, не был ли пользователь, который передал этот код, сам собой.
3. Если проверки прошли успешно, сервер создает запись в базе данных, связывающую пользователя, который активировал инвайт-код, с пользователем, чей инвайт-код был использован.

## Зависимости

- Django
- Django Rest Framework
- phonenumbers
- rest_framework_simplejwt
- PostgreSQL

## Запуск в контейнере

1. Клонируйте репозиторий: `git clone https://github.com/talasov/Referral_system.git`
2. Добавле файл `.env` :
```python
SECRET_KEY = "Ваш секретный ключ"
DB_NAME=postgres
POSTGRES_USER=postgres
POSTGRES_PASSWORD=password
DB_HOST=db
DB_PORT=5432
DEBUG=True
```
3. Создайте образ `docker-compose build`
4. Запустите контейнер `docker-compose up`
5. Сервер запуститься, миграции выполнятся автоматически 
